// ==========================================
// GORWELD.COM - COMPLETE JAVASCRIPT
// The Furnace Never Sleeps
// ==========================================

// ========== CONFIG ========== 
const CONFIG = {
    contractAddress: 'GORWELD_CONTRACT_ADDRESS_HERE',
    coingeckoId: 'gorweld', // ZmieÅ„ gdy bÄ™dzie na CoinGecko
    updateInterval: 30000, // 30 sekund
};

// ========== INIT ========== 
document.addEventListener('DOMContentLoaded', () => {
    initSparks();
    initNavigation();
    initPriceUpdates();
    initWeldCounter();
    initNewsletter();
    initScrollAnimations();
});

// ========== SPARKS ANIMATION ========== 
function initSparks() {
    const container = document.getElementById('sparks');
    const sparkCount = 50;
    
    for (let i = 0; i < sparkCount; i++) {
        createSpark(container);
    }
    
    // Regeneruj co 2 sekundy
    setInterval(() => {
        if (container.children.length < sparkCount) {
            createSpark(container);
        }
    }, 2000);
}

function createSpark(container) {
    const spark = document.createElement('div');
    spark.className = 'spark';
    spark.style.left = Math.random() * 100 + '%';
    spark.style.bottom = '0';
    spark.style.animationDelay = Math.random() * 2 + 's';
    spark.style.animationDuration = (Math.random() * 2 + 1) + 's';
    
    container.appendChild(spark);
    
    // UsuÅ„ po animacji
    setTimeout(() => {
        spark.remove();
    }, 3000);
}

// ========== NAVIGATION ========== 
function initNavigation() {
    const navToggle = document.getElementById('navToggle');
    const navLinks = document.querySelector('.nav-links');
    
    navToggle?.addEventListener('click', () => {
        navLinks.classList.toggle('active');
    });
    
    // Zamknij menu po klikniÄ™ciu linku
    document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', () => {
            navLinks.classList.remove('active');
        });
    });
}

// ========== PRICE UPDATES ========== 
async function initPriceUpdates() {
    await updatePrice();
    setInterval(updatePrice, CONFIG.updateInterval);
}

async function updatePrice() {
    try {
        // Dla testÃ³w - uÅ¼yj Gorbagana jako placeholder
        const response = await fetch(
            `https://api.coingecko.com/api/v3/simple/price?ids=gorbagana&vs_currencies=usd&include_24hr_change=true&include_market_cap=true&include_24h_vol=true`
        );
        
        if (!response.ok) throw new Error('API Error');
        
        const data = await response.json();
        const gor = data.gorbagana || {};
        
        // Update wszystkich elementÃ³w
        updateElement('price', `$${formatPrice(gor.usd)}`);
        updateElement('price-large', `$${formatPrice(gor.usd)}`);
        
        const change = gor.usd_24h_change || 0;
        const changeFormatted = `${change > 0 ? '+' : ''}${change.toFixed(2)}%`;
        updateElement('change', changeFormatted);
        updateElement('change-large', changeFormatted);
        
        // Ustaw kolor zmiany
        const changeElements = document.querySelectorAll('#change, #change-large, .price-change');
        changeElements.forEach(el => {
            el.className = change > 0 ? 'price-change up' : 'price-change down';
        });
        
        updateElement('volume', `$${formatNumber(gor.usd_24h_vol)}`);
        updateElement('mcap', `$${formatNumber(gor.usd_market_cap)}`);
        
        console.log('âœ“ Price updated');
    } catch (error) {
        console.error('Price update failed:', error);
        updateElement('price', '$--.------');
        updateElement('change', '--.--%');
    }
}

function updateElement(id, value) {
    const element = document.getElementById(id);
    if (element) {
        element.textContent = value;
        element.classList.add('fade-in');
        setTimeout(() => element.classList.remove('fade-in'), 600);
    }
}

function formatPrice(price) {
    if (!price) return '0.000000';
    if (price < 0.000001) return price.toFixed(8);
    if (price < 0.01) return price.toFixed(6);
    if (price < 1) return price.toFixed(4);
    return price.toFixed(2);
}

function formatNumber(num) {
    if (!num) return '0';
    if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
    if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
    if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
    return num.toFixed(2);
}

// ========== WELD COUNTER ========== 
function initWeldCounter() {
    const counter = document.getElementById('total-welds');
    if (!counter) return;
    
    let count = 0;
    const target = Math.floor(Math.random() * 10000) + 50000;
    const duration = 2000;
    const increment = target / (duration / 16);
    
    const timer = setInterval(() => {
        count += increment;
        if (count >= target) {
            count = target;
            clearInterval(timer);
        }
        counter.textContent = Math.floor(count).toLocaleString();
    }, 16);
}

// ========== CONTRACT COPY ========== 
function copyContract() {
    const contract = document.getElementById('contract');
    if (!contract) return;
    
    const text = contract.textContent;
    
    navigator.clipboard.writeText(text).then(() => {
        alert('ğŸ”¥ Contract address copied to clipboard!');
    }).catch(err => {
        console.error('Copy failed:', err);
        // Fallback
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        alert('ğŸ”¥ Contract address copied!');
    });
}

// ========== NEWSLETTER ========== 
function initNewsletter() {
    const form = document.getElementById('newsletter-form');
    if (!form) return;
    
    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = form.querySelector('input[type="email"]').value;
        const button = form.querySelector('button');
        const originalText = button.textContent;
        
        button.textContent = 'WELDING...';
        button.disabled = true;
        
        try {
            // Tutaj dodaj integracjÄ™ z Mailchimp/ConvertKit/etc
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            alert('ğŸ”¥ Welcome to the Foundry! Check your email.');
            form.reset();
        } catch (error) {
            alert('âš ï¸ Welding failed. Try again.');
        } finally {
            button.textContent = originalText;
            button.disabled = false;
        }
    });
}

// ========== SCROLL ANIMATIONS ========== 
function initScrollAnimations() {
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -100px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('fade-in');
            }
        });
    }, observerOptions);
    
    // Obserwuj elementy
    document.querySelectorAll('.forge-card, .chain-link, .forge-stage, .social-card').forEach(el => {
        observer.observe(el);
    });
}

// ========== UTILITY FUNCTIONS ========== 
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// ========== GLOBAL FUNCTIONS (called from HTML) ========== 
window.copyContract = copyContract;

// ========== CONSOLE MESSAGE ========== 
console.log(`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                       â•‘
â•‘         ğŸ”¥ GORWELD.COM ğŸ”¥            â•‘
â•‘     The Furnace Never Sleeps         â•‘
â•‘                                       â•‘
â•‘  Market burns. I weld.               â•‘
â•‘  Â© 2026 Imperium Ferri               â•‘
â•‘                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`);
```

---

